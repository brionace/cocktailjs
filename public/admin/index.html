<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Smartender Assets Admin</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      body {
        font-family:
          system-ui,
          -apple-system,
          Arial,
          sans-serif;
        padding: 16px;
      }
      .grid {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
      }
      .card {
        width: 160px;
        border: 1px solid #eee;
        padding: 8px;
        border-radius: 6px;
      }
      .svg-thumb {
        position: relative;
        width: 140px;
        height: 80px;
        background: #fafafa;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .grid .card svg {
        width: 100px !important;
        height: 100px !important;
        display: block; /* remove inline whitespace */
        max-width: none; /* allow explicit sizing */
      }
      textarea {
        width: 100%;
        height: 80px;
      }
      input[type="text"] {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <h1>Assets Admin</h1>
    <p>
      List and edit glasses. Changes persist to the assets manifest and SVG
      files.
    </p>

    <h2>Glasses</h2>
    <div id="glasses" class="grid"></div>

    <h2>Playground</h2>
    <p>Interactive component playground (embedded):</p>
    <div style="border: 1px solid #ddd; height: 480px">
      <iframe
        src="/playground/"
        style="border: 0; width: 100%; height: 100%"
        title="cocktailjs-react playground"
      ></iframe>
    </div>
    <p>
      If you prefer a separate window,
      <a href="http://localhost:5173" target="_blank" rel="noopener"
        >open the playground</a
      >.
    </p>

    <script>
      // Try the proxied playground first, fall back to direct Vite URL if proxy fails.
      (function () {
        const iframe = document.querySelector('iframe[src="/playground/"]');
        if (!iframe) return;
        const proxied = "/playground/";
        const direct = "http://localhost:5173/";

        const timeout = (ms) => new Promise((res) => setTimeout(res, ms));

        // Probe the proxied URL with fetch; if it fails or responds >=400, switch to direct.
        Promise.race([
          fetch(proxied, { method: "GET" })
            .then((r) => ({ ok: r.ok, status: r.status }))
            .catch(() => ({ ok: false })),
          timeout(1800).then(() => ({ ok: false, timedOut: true })),
        ]).then((result) => {
          if (result && result.ok) {
            console.log("Playground proxy reachable; using", proxied);
            iframe.src = proxied;
          } else {
            console.warn(
              "Playground proxy not reachable, falling back to direct Vite URL",
            );
            iframe.src = direct;
            const note = document.createElement("div");
            note.style.marginTop = "8px";
            note.style.color = "#b00";
            note.textContent =
              "Playground proxy unavailable â€” using direct dev server at " +
              direct;
            iframe.parentNode.parentNode.insertBefore(
              note,
              iframe.parentNode.nextSibling,
            );
          }
        });
      })();
    </script>
    <script src="/admin/admin.js"></script>
  </body>
</html>
